function start(){feeDict=gon.dict,destination=gon.destination,addListeners(),createFboList(),fillAppliedFeesDict(),filterButtonClicked(curFilter)}function addListeners(){document.getElementById("filters").onchange=function(){filterButtonClicked()},document.getElementById("locationIcon").onchange=function(){filterButtonClicked("distance")},document.getElementById("landing").onclick=function(){feeButtonClicked("landing")},document.getElementById("tie down").onclick=function(){feeButtonClicked("tie down")},document.getElementById("ramp").onclick=function(){feeButtonClicked("ramp")},document.getElementById("facility").onclick=function(){feeButtonClicked("facility")},document.getElementById("call out").onclick=function(){feeButtonClicked("call out")},document.getElementById("other").onclick=function(){feeButtonClicked("other")}}function createFboList(){var e=Object.keys(feeDict);if(e.length>fbos.length)for(var t=0;t<e.length;t++){var n={name:"",distance:0,total:0};n.name=e[t],n.distance=parseInt(feeDict[e[t]].distance.substring(0,feeDict[e[t]].distance.length-4)),n.total=feeDict[e[t]].total,this.fbos.push(n)}}function fillAppliedFeesDict(){appliedFees.landing=!0,appliedFees["tie down"]=!0,appliedFees.ramp=!0,appliedFees.facility=!0,appliedFees["call out"]=!0,appliedFees.other=!0,document.getElementById("landing").checked=!0,document.getElementById("ramp").checked=!0,document.getElementById("tie down").checked=!0,document.getElementById("call out").checked=!0,feeButtonClicked("tie down"),feeButtonClicked("call out")}function filterButtonClicked(){var e=document.getElementById("filters"),t=e.options[e.selectedIndex].value;curFilter=t,curFilter="cost"===t?"cost":"distance",arrangeResults(),updateTable()}function feeButtonClicked(e){if(appliedFees[e]){appliedFees[e]=!1;document.getElementById(e);document.getElementById(e).checked=!1}else{appliedFees[e]=!0;document.getElementById(e);document.getElementById(e).checked=!0}updateTotalCost(),arrangeResults(),updateTable()}function updateTotalCost(){for(var e=Object.keys(appliedFees),t=0;t<this.fbos.length;t++){for(var n=!1,a=0,i=0;i<e.length;i++)null!=feeDict[fbos[t].name][e[i]]&&(n=!0,appliedFees[e[i]]&&(a+=feeDict[fbos[t].name][e[i]]));n?(fbos[t].total=a,feeDict[fbos[t].name].total=a):(fbos[t].total=1000001,feeDict[fbos[t].name].total=1000001)}}function arrangeResults(){"cost"===curFilter?fbos.sort(compairPrice):fbos.sort(compairDistance)}function compairPrice(e,t){var n=parseInt(e.total),a=parseInt(t.total);return n<a?-1:n>a?1:compairDistance(e,t)}function compairDistance(e,t){var n=parseInt(e.distance),a=parseInt(t.distance);if(1000001==parseInt(e.total)||1000001==parseInt(t.total)){if(parseInt(e.total)<parseInt(t.total))return-1;if(parseInt(e.total)>parseInt(t.total))return 1}return n<a?-1:n>a?1:parseInt(e.total)!=parseInt(t.total)?compairPrice(e,t):void 0}function properCapitlize(e){return e.toLowerCase().replace(/\b./g,function(e){return e.toUpperCase()})}function updateTable(){var e=document.getElementById("allResults");e.innerHTML="";var t="",n=0,a=Array(fbos.length);if(0!=fbos.length)for(var i=0;i<this.fbos.length;i++){var o=fbos[i].name;if(n>1)break;1000001==feeDict[o].total&&(n+=1);var c=document.createElement("div");c.setAttribute("class","result");var l=document.createElement("table");l.setAttribute("class","resultTable");var d=l.insertRow(l.rows.length),r=document.createElement("td"),p=document.createElement("H3");p.appendChild(document.createTextNode(i+1+". "+properCapitlize(feeDict[o].airport))),r.appendChild(p),d.appendChild(r);var s=document.createElement("td"),u=document.createElement("H3");u.setAttribute("class","center"),u.appendChild(document.createTextNode(feeDict[o].distance)),s.appendChild(u),d.appendChild(s);var m=document.createElement("td"),f=document.createElement("H4");1000001==feeDict[o].total?f.appendChild(document.createTextNode("Unknown Cost")):f.appendChild(document.createTextNode("Total Cost: $"+feeDict[o].total)),m.setAttribute("class","right"),m.appendChild(f),d.appendChild(m);var h=document.createElement("td");a[i]=document.createElement("button"),a[i].innerHTML="Book Trip",a[i].setAttribute("id",i),a[i].onclick=function(){linkToBookTrip(this.id)},h.setAttribute("class","center"),h.appendChild(a[i]),d.appendChild(h);var g=l.insertRow(l.rows.length),C=document.createElement("td"),b=document.createElement("H4");b.appendChild(document.createTextNode("\xa0\xa0"+properCapitlize(o))),C.appendChild(b),g.appendChild(C);var k=document.createElement("td"),D="",E="";null!=feeDict[o].landing?D+="Landing: $"+feeDict[o].landing:D+="Landing: Unknown",null!=feeDict[o].ramp?E+="Ramp: $"+feeDict[o].ramp:E+="Ramp: Unknown",k.appendChild(document.createTextNode(D)),k.appendChild(document.createElement("br")),k.appendChild(document.createTextNode(E)),g.appendChild(k);var y=document.createElement("td"),B="",I="";null!=feeDict[o]["tie down"]?B+="Tie-Down: $"+feeDict[o]["tie down"]:B+="Tie-Down: Unknown",null!=feeDict[o]["call out"]?I+="Call-Out: $"+feeDict[o]["call out"]:I+="Call-Out: Unknown",y.appendChild(document.createTextNode(B)),y.appendChild(document.createElement("br")),y.appendChild(document.createTextNode(I)),g.appendChild(y);var v=document.createElement("td"),T=0,w="";null!=feeDict[o].facility?(T+=feeDict[o].facility,null!=feeDict[o].other?T+="Other: $"+(feeDict[o].other+T):w+="Other: $"+T):null!=feeDict[o].other?w+="Other: $"+feeDict[o].other:w+="Other: Unknown",v.appendChild(document.createTextNode(w)),g.appendChild(v),c.appendChild(l),e.appendChild(c),t+="&markers=color:red|label:"+(i+1)+"|"+feeDict[o].latitude+","+feeDict[o].longitude}else{var c=document.createElement("div");c.setAttribute("class","result");var F=document.createElement("H3");F.appendChild(document.createTextNode("Sadly, it seems there are no airports within the mile radius you selected for this city. Try again with a larger radius, or from another nearby city. Sorry for any inconveince!")),c.appendChild(F),e.appendChild(c)}createGoogleMap(t)}function linkToBookTrip(e){var t=fbos[parseInt(e)].name,n=feeDict[t].airport,a=gon.tailnumber,i=gon.time,o=gon.time2,c=feeDict[t].total;window.location="https://chartair-fuzzykitenz.c9users.io/book_trip?fbo="+t+"&airport="+n+"&cost="+c+"&tailnumber="+a+"&time="+i+"&time2="+o}function createGoogleMap(e){var t=document.getElementById("googleMap"),n="&markers=color:blue|label:D|"+destination,a="http://maps.google.com/maps/api/staticmap?size=512x512&maptype=roadmap&sensor=false"+n+e;t.src=a}window.addEventListener("load",start,!1);var feeDict,fbos=[],curFilter,appliedFees={},destination;